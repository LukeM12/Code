YUI.add("search-url",function(e){var t,n,r,i=/^bw|blackandwhite$/;YUI.Env.isServer?t=require("querystring").stringify:t=function(e){var t=[],n,r,i;for(n in e)if(e.hasOwnProperty(n))if(Array.isArray(e[n]))for(r=0,i=e[n].length;r<i;r++)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n][r]));else t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},r={truetrue7:"all",truefalse1:"photos",truetrue1:"all",truetrue4:"all",falsetrue5:"videos",falsefalse5:"photos",falsefalse3:"photos",truefalse6:"photos",truetrue6:"all",falsetrue1:"videos",falsefalse7:"all"},n=function(t,r){var i;r&&(this.appContext=r),this.params=e.merge(t);for(i in this.params)this.params.hasOwnProperty(i)&&(this.params[i]=e.AttributeHelpers.coerceString(this.params[i]));this.params.color_codes&&(this.params.color_codes=""+this.params.color_codes,this.colors=this.params.color_codes.split(",")),this.setBasePath(n.searchTypes.GENERAL)},n.prototype.setBasePath=function(e){var t="/search/";switch(e){case n.searchTypes.PEOPLE:t+="people/";break;case n.searchTypes.GROUPS:case n.searchTypes.POOL:t+="groups/";break;case n.searchTypes.GENERAL:case n.searchTypes.UNIFIED:case n.searchTypes.YOURS:case n.searchTypes.CONTACTS:case n.searchTypes.NSID:default:}return this.urlPath=t,this},n.prototype.getAPIParams=function(){return e.merge(this.params)},n.prototype.setAPIParam=function(t,n){return this.params[t]=e.AttributeHelpers.coerceString(n),this},n.prototype.getURL=function(){return this.urlPath+"?"+this.getId()},n.prototype.getId=function(){var r={},i,s=e.SearchHelper.API;for(i in this.params)s[i]?r[s[i]]=this.params[i]:r[i]=this.params[i];return t(r)||n.EMPTY_SEARCH_ID},n.prototype.removeAPIParam=function(e){return delete this.params[e],this},n.prototype.clone=function(){return new n(this.params,this.appContext)},n.prototype._syncColors=function(){this.colors&&this.colors.length>0?this.params.color_codes=this.colors.join(","):this.removeAPIParam("color_codes")},n.prototype.addColorCode=function(e){if(e&&e.match(i)){this.clearColorCodes(),this.colors=["bw"],this._syncColors();return}this.colors&&this.colors.indexOf("bw")!==-1&&(this.colors=[]),this.colors||(this.colors=[]),this.colors.indexOf(e)===-1&&(this.colors.push(e),this._syncColors())},n.prototype.removeColorCode=function(e){var t;this.colors&&(t=this.colors.indexOf(e),t!==-1&&(this.colors.splice(t,1),this._syncColors()))},n.prototype.clearColorCodes=function(){this.colors=[],this._syncColors()},n.prototype.setMedia=function(e,t){var n,i,s;e||(e=!1),t||(t=!1),e&&t?s="all":e?s="photos":s="videos",n=this.params.content_type?this.params.content_type:7,i=r[e.toString()+t.toString()+n],i&&(s=i),this.setAPIParam("media",s)},n.prototype.getMedia=function(){var e=this.params.media,t=this.params.content_type,n={photos:!0,videos:!0};e==="photos"?n.videos=!1:e==="videos"&&(n.photos=!1);if(t==="3"||t==="5")n.videos=!1,n.photos=!1;return n},n.searchTypes={GENERAL:0,UNIFIED:1,PEOPLE:2,GROUPS:3,YOURS:4,POOL:5,CONTACTS:6,NSID:7},n.EMPTY_SEARCH_ID="-1",e.SearchUrl=n},"@VERSION@",{requires:["search-helper","attribute-helpers"]});
YUI.add("search-photos-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photos-search"].run(t,this.appContext)}},attributes:{photos:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-photos-search"],listItemIdField:"photoId"}},totalItems:{setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},apiParams:{writeOnce:"initOnly"},emptyQuery:{defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-search-fetcher","search-helper"]});
YUI.add("flickr-photos-search-fetcher",function(e){"use strict";function t(t){var n={extras:e.APIHelper.request.getRebootPhotoExtras(),per_page:t.perPage||e.SearchHelper.FETCH_PAGE_SIZE,page:t.page||1},r;return t.fetchGeo&&(n.extras+=",geo"),r=e.merge(n,t.apiParams||{}),r.color_codes&&r.color_codes==="bw"&&(delete r.color_codes,r.text=r.text+" blackandwhite"),YUI.Env.isServer&&e.SearchHelper.unescapeParameters(r),e.SearchHelper.isParameterlessSearch(r)?null:r}function n(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l,c,h={id:n.id||e.SearchUrl.EMPTY_SEARCH_ID,apiParams:{},emptyQuery:!!n.emptyQuery,photos:[]},p,d;n.id&&n.id!==e.SearchUrl.EMPTY_SEARCH_ID&&(h.apiParams=e.QueryString.parse(n.id));if(!n.id)throw new ReferenceError("No `id` provided by request.");if(!r.photos||!r.photos.photo)throw new Error("No `photos.photo` property returned by API.");return c=e.APIHelper.response.parsePhotos({photos:r.photos.photo,photoModelRegistry:s,personModelRegistry:o,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),n.fetchGeo&&r.photos.photo.forEach(function(e){typeof e.latitude!="undefined"?p={id:e.id,hasGeo:!0,latitude:e.latitude,longitude:e.longitude}:p={id:e.id,hasGeo:!1},f.exists(p.id)||f.add(p)}),h.photos={perPage:r.photos.perpage,page:r.photos.page||1,pageContent:c,totalItems:r.photos.total},h.totalItems=r.photos.total,i.exists(h.id)?(l=i.getValue(h.id,"photos").getList(),d=l.reduce(function(e,t){return e[t.id]=!0,e},{}),h.photos.pageContent=h.photos.pageContent.filter(function(e){return!d[e.id]}),h.photos.page===1&&(h.photos.forceAppend=!0),i.setValue(h.id,"photos",h.photos)):i.add(h),h.photos.pageContent}function r(t,n){var r=this,i="flickr.photos.search",s=t.emptyQuery?{}:this._processParams(t);return s||(t.emptyQuery=!0),e.Promise.all([t.emptyQuery?e.Promise.resolve({photos:{photo:[]}}):n.callAPI(i,s),n.getModelRegistry("search-photos-models"),n.getModelRegistry("photo-models"),n.getModelRegistry("person-models"),n.getModelRegistry("photo-engagement-models"),n.getModelRegistry("photo-stats-models"),n.getModelRegistry("photo-geo-models")]).then(function(e){return r._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-photos-search-fetcher] failed getting or processing API response:",e),e})}e.namespace("ListFetchers")["flickr-photos-search"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","type-validator","search-helper","search-url","querystring-parse-simple"],optional:["search-photos-models","photo-models","person-models","photo-engagement-models","photo-stats-models","photo-geo-models"]});
YUI.add("hermes-template-big-input-search",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){var r="",i;return r+='placeholder="',(i=n.searchPlaceholder)?i=i.call(e,{hash:{},data:t}):(i=e.searchPlaceholder,i=typeof i===u?i.apply(e):i),r+=a(i)+'"',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<form class="ui-large-search" action="/search/" method="get" role="search">\n    <input type="text" name="text" value="" class="ui-huge-input" autocomplete="off" aria-label="Search" role="textbox"\n		',o=n["if"].call(t,t.searchPlaceholder,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;return s+=' autofocus>\n    <label class="submitLabel">\n        <input type="submit" data-track="gnSearchBigSearchIcon" class="large-search-icon" tabindex="-1" aria-label="Search" role="button">\n	</label>\n</form>',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/big-input-search",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-search-photos-page",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return"ui-search-no-matches"}function d(e,t){return"ui-state-no-query"}function v(e,t){return"ui-state-api-fail"}function m(e,t){var i="",s,o,u;i+="\n		<header>\n			<h2>"+l((s=(s=(s=e.searchState,s==null||s===!1?s:s.noMatchesForQuery),s==null||s===!1?s:s.noMatchesText),typeof s===f?s.apply(e):s))+"</h2>\n			<h2>",u={hash:{intlName:"search.TRY_DIFFERENT"},data:t},i+=l((s=n.intlMessage||e.intlMessage,s?s.call(e,u):c.call(e,"intlMessage",u)))+"</h2>\n		</header>\n		",o=h.invokePartial(r["big-input-search"],"big-input-search",e,n,r,t);if(o||o===0)i+=o;return i+="\n	",i}function g(e,t){var i="",s;i+="\n\n		",s=h.invokePartial(r["big-input-search"],"big-input-search",e,n,r,t);if(s||s===0)i+=s;return i+='\n\n		<div class="ui-footer-fader">\n			<a href="'+l((s=(s=e.attribution,s==null||s===!1?s:s.link),typeof s===f?s.apply(e):s))+'" class="ui-background-attribution">'+l((s=(s=e.attribution,s==null||s===!1?s:s.by),typeof s===f?s.apply(e):s))+"</a>\n		</div>\n\n	",i}function y(e,t){var i="",s,o,u;i+="\n		<header>\n			<h2>",u={hash:{intlName:"search.API_ERROR_HEADER"},data:t},i+=l((s=n.intlMessage||e.intlMessage,s?s.call(e,u):c.call(e,"intlMessage",u)))+"</h2>\n			<h2>",u={hash:{intlName:"search.API_ERROR_SUBHEADER"},data:t},i+=l((s=n.intlMessage||e.intlMessage,s?s.call(e,u):c.call(e,"intlMessage",u)))+"</h2>\n		</header>\n		",o=h.invokePartial(r["big-input-search"],"big-input-search",e,n,r,t);if(o||o===0)i+=o;return i+="\n	",i}function b(e,t){var r="",i,s;return r+="\n	",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["footer-full-view"],s):c.call(e,"outlet",e["footer-full-view"],s)))+"\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=this.merge(r,e.partials),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing,h=this;a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["global-nav-view"],a):c.call(t,"outlet",t["global-nav-view"],a)))+"\n",a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["filter-bar-neutered-view"],a):c.call(t,"outlet",t["filter-bar-neutered-view"],a)))+'\n<main class="',u=n["if"].call(t,(o=t.searchState,o==null||o===!1?o:o.noMatchesForQuery),{hash:{},inverse:h.noop,fn:h.program(1,p,i),data:i});if(u||u===0)s+=u;s+=" ",u=n["if"].call(t,(o=t.searchState,o==null||o===!1?o:o.noQuery),{hash:{},inverse:h.noop,fn:h.program(3,d,i),data:i});if(u||u===0)s+=u;s+=" ",u=n["if"].call(t,(o=t.searchState,o==null||o===!1?o:o.apiFailed),{hash:{},inverse:h.noop,fn:h.program(5,v,i),data:i});if(u||u===0)s+=u;s+='" role="main">\n\n	',a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["search-photos-collection-view"],a):c.call(t,"outlet",t["search-photos-collection-view"],a)))+"\n\n	",u=n["if"].call(t,(o=t.searchState,o==null||o===!1?o:o.noMatchesForQuery),{hash:{},inverse:h.noop,fn:h.program(7,m,i),data:i});if(u||u===0)s+=u;s+="\n\n	",u=n["if"].call(t,(o=t.searchState,o==null||o===!1?o:o.noQuery),{hash:{},inverse:h.noop,fn:h.program(9,g,i),data:i});if(u||u===0)s+=u;s+="\n\n	",u=n["if"].call(t,(o=t.searchState,o==null||o===!1?o:o.apiFailed),{hash:{},inverse:h.noop,fn:h.program(11,y,i),data:i});if(u||u===0)s+=u;s+="\n\n</main>\n\n",a={hash:{},inverse:h.noop,fn:h.program(13,b,i),data:i},u=(o=n.isFlipped||t.isFlipped,o?o.call(t,t.flippers,"enable-styleguide-footer",a):c.call(t,"isFlipped",t.flippers,"enable-styleguide-footer",a));if(u||u===0)s+=u;return s+="\n",s}),r={};e.Array.each(["big-input-search","big-input-search","big-input-search"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-photos-page",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-big-input-search","hermes-template-big-input-search","hermes-template-big-input-search"]});
YUI.add("collection-paginator",function(e){var t=100,n=e.CollectionPaginator=function(e,n,r){r&&r.page?this.page=this.startPage=r.page-1:this.page=this.startPage=0,r&&r.fetchPageSize?this.perPage=r.fetchPageSize:this.perPage=t,r&&r.viewPageSize?this.viewPageSize=r.viewPageSize:this.viewPageSize=Number.MAX_VALUE,this.lastPage=this.startPage+Math.ceil(this.viewPageSize/this.perPage),this.modelProxy=e,this.listAttr=n,this.prepending=!1,this._advanceToFirstIncompletePage(),this.valuesChangedHandle=this.modelProxy.on("valuesChanged",this._onValuesChanged.bind(this),!0)};n.prototype={passAttributesToFetcher:function(e){this.fetcherParamAttrs=e instanceof Array?e:[e]},next:function(e){return this.page<this.lastPage&&this.page++,this._getPage()},prev:function(e){return this.page>0&&this.page--,this._getPage()},getCollectionAsList:function(){return this.modelProxy.getValue(this.listAttr).getList()},getCurrentPageAsList:function(){var t=this.modelProxy.getValue(this.listAttr).getList(),n=this.startPage*this.perPage,r=n+this.viewPageSize;return t=t.slice(n,r),t.length&&(t=e.FlickrCollection.trimArray(t)),t},currentPageIsLoaded:function(){return this.getCurrentPageAsList().length===this.viewPageSize||this.modelProxy.getValue(this.listAttr).fetchedEnd},_getPage:function(){var e={},t=this.modelProxy.getValue(this.listAttr).getList(),n=(this.page-1)*this.perPage,r=this.page*this.perPage,i=this.startPage*this.perPage+this.viewPageSize,s=!1,o,u=this;if(this.viewPageSize<1e3&&this.page&&this.perPage){for(o=r+1;o<i;o++)if(typeof t[o]!="undefined"){s=!0;break}if(s)for(o=n;o<r;o++)if(typeof t[o]=="undefined"){this.prepending=!0;break}}return this.page&&(e.page=this.page),this.perPage&&(e.perPage=this.perPage),this.fetcherParamAttrs&&this.fetcherParamAttrs.forEach(function(t){e[t]=u.modelProxy.getValue(t)}),this.modelProxy.getValue(this.listAttr).getPage(e)},_onValuesChanged:function(e){var t;e[this.listAttr]&&e[this.listAttr].listDiff&&(t=e[this.listAttr].listDiff,this.prepending&&(this.prepending=!1,t.prepended=t.added),this.fire("listValueChanged",t))},_advanceToFirstIncompletePage:function(){var e=this.modelProxy.getValue(this.listAttr).getList(),t;if(this.viewPageSize===Number.MAX_VALUE)this.page=Math.floor(this.getCollectionAsList().length/this.perPage);else while(this.page<this.lastPage){t=e.slice(this.page*this.perPage,(this.page+1)*this.perPage);if(!(t.length>=this.perPage&&t.every(function(e){return typeof e!="undefined"})))break;this.page++}}},e.augment(n,e.EventTarget)},"@VERSION@",{requires:["event-custom","flickr-collection"]});
YUI.add("simple-event-emitter",function(e){"use strict";var t=function(){this.__events={},this.__state={}};t.prototype={on:function(e,t,n){this.__events[e]||(this.__events[e]=[]),this.__events[e].push([t,n||this])},fire:function(e){var t=Array.prototype.slice.call(arguments,1);this.__events[e]&&this.__events[e].forEach(function(e){e[0].apply(e[1],t)}),this.__state[e]=!0},detach:function(e,t){if(!t){this.__events[e]=[];return}this.__events[e]&&(this.__events[e]=this.__events[e].filter(function(e){return t===e[0]?!1:!0}))},is:function(e,t){return t===undefined?!!this.__state[e]:this.__state[e]=!!t},destroy:function(){this.__events=null,this.__state=null}},e.SimpleEventEmitter=t},"@VERSION@",{requires:[]});
YUI.add("asset-manager",function(e){"use strict";var t,n,r=e.flutil;n={normalizeAspect:{min:.65,max:10,fill:"#111111"},deferLoading:!1,placeHolderImg:"https://s.yimg.com/pw/images/spaceball.gif",errorImg:"https://s.yimg.com/pw/images/spaceball.gif",imgSelector:".ui-display-image",fadeOutClass:"ui-state-fade-out",detectHighDensityDisplay:!1,maxUpSampleAmount:.05,enableClassWidth:!1},t=e.AssetManager=function(t,i){e.SimpleEventEmitter.apply(this),this.options=r.extend({container:null,imgSelector:n.imgSelector,imgNode:null,normalizeAspect:!1,placeHolderImg:n.placeHolderImg,errorImg:n.errorImg,fadeOutClass:n.fadeOutClass,detectHighDensityDisplay:n.detectHighDensityDisplay,maxUpSampleAmount:n.maxUpSampleAmount,deferLoading:n.deferLoading,enableClassWidth:n.enableClassWidth},i),this.photo=t,this.options.normalizeAspect?this.normalize=r.extend({},n.normalizeAspect,this.options.normalizeAspect===!0?null:this.options.normalizeAspect):this.normalize={min:0,max:999},this.init()},t.prototype=r.objectCreate(e.SimpleEventEmitter.prototype,{init:function(e){e||(e=this.options),this.container=e.container,this.imgNode=e.imgNode||null,this.source=null,this.previous=null,this.sizes=null,this.width=0,this.height=0,this._hidden=!0,this._loaded=null,this._timers={},this.generateSizes()},generateSizes:function(){var e,t=this,n=this.photo.getValue("needsInterstitial"),r;e=this.photo.getValue("sizes"),r=Object.keys(e).reduce(function(r,i){if(i==="o")return r;if(t.options.noSquares)if(i==="q"||i==="sq")return r;var s=e[i];return s.url=s.url.replace(/^http:/i,"https:"),r.push({size:i,src:n?t.options.placeHolderImg:s.url,width:parseInt(s.width,10),height:parseInt(s.height,10),loaded:!1,_img:null,_cbs:[]}),r},[]),this.sizes=r.sort(function(e,t){return t.height-e.height})},updateHost:function(){if(!this.options.enableClassWidth||!this.container)return;var e,t=this.width,n=this.container.getDOMNode();t>400?e="ui-width-full":t>325?e="ui-width-large":t>250?e="ui-width-medium":t>175?e="ui-width-small":t>100?e="ui-width-mini":e="ui-width-nano",n.classList.remove("ui-width-full"),n.classList.remove("ui-width-large"),n.classList.remove("ui-width-medium"),n.classList.remove("ui-width-small"),n.classList.remove("ui-width-mini"),n.classList.remove("ui-width-nano"),n.classList.add(e)},updateImageNode:function(){var e=this;this.getImageNode(function(t){var n={width:e.naturalWidth+"px",height:e.naturalHeight+"px"};e.paddingLeft&&(n["border-left"]=[e.paddingLeft+"px","solid",e.normalize.fill].join(" ")),e.paddingLeft||(n["border-left"]="none"),e.paddingRight&&(n["border-right"]=[e.paddingRight+"px","solid",e.normalize.fill].join(" ")),e.paddingRight||(n["border-right"]="none"),t.setStyles(n),e.load()})},setSize:function(e,t){var n=this.options.maxUpSampleAmount,r,i,s,o,u,a,f,l,c;u=this.sizes[0];for(l=0,c=this.sizes.length;l<c;l++){o=this.sizes[l];if(o.height<t){a=u,f=o,s=t*n,r=Math.abs(a.height-t),i=Math.abs(f.height-t),i<r&&i<=s?this.render(e,t,f):this.render(e,t,a);return}u=o}this.render(e,t,this.sizes[0])},render:function(e,t,n){var r;this.previous=this.getSize(),this.source=n||{error:"no source"},e||(e=this.getScaledWidth(t)),t||(t=this.getScaledHeight(e)),this.width=e,this.height=t,this.naturalWidth=this.getNaturalScaledWidth(this.height),this.naturalHeight=this.height,this.paddingLeft=this.paddingRight=this.croppingHorizontal=0,this.source.size==="q"&&(this.naturalWidth=this.naturalHeight=this.width=this.height),r=this.width-this.naturalWidth,r>0?(this.paddingLeft=Math.floor(r/2),this.paddingRight=r-this.paddingLeft):this.croppingHorizontal=r/2>>0,this.updateHost(),this.updateImageNode()},getNaturalAspectRatio:function(){return this.sizes[0].width/this.sizes[0].height},getNaturalScaledHeight:function(e){return Math.ceil(1/this.getNaturalAspectRatio()*e)},getNaturalScaledWidth:function(e){return Math.ceil(this.getNaturalAspectRatio()*e)},getAspectRatio:function(){var e=this.getNaturalAspectRatio();return e<this.normalize.min?this.normalize.min:e>this.normalize.max?this.normalize.max:e},getScaledHeight:function(e){return Math.ceil(1/this.getAspectRatio()*e)},getScaledWidth:function(e){return Math.ceil(this.getAspectRatio()*e)},getImageNode:function(e,t){var n=this;t===undefined&&(t=10);if(!t)return;if(!this.container)return;this.imgNode||(this.imgNode=this.container.one(this.options.imgSelector),this.imgNode&&(this.imgNode.getDOMNode().onload=null));if(e&&!YUI.Env.isServer){if(!this.imgNode){n._timers.getImageNode=setTimeout(function(){n.getImageNode(e,t-1)},10);return}return e(this.imgNode)}return this.imgNode||null},load:function(){var e=this,t,n=this.getImageNode();if(!n)return;t=function(){n.getAttribute("src")!==e.source.src&&n.set("src",e.source.src),e.show()},this.queueResource(this.source,t)},queueResource:function(e,t){if(YUI.Env.isServer)return!1;if(e.loaded)return t&&t(),!0;if(!e._img){e._img=new Image,e._img.onload=function(){if(e.loaded)return;e.loaded=!0;while(e._cbs.length)e._cbs.shift()();e._img=null},e._img.onerror=function(){e._img=null},t&&e._cbs.push(t),e._img.src=e.src;if(e._img.complete){e.loaded=!0;while(e._cbs.length)e._cbs.shift()();return e._img=null,!0}}else t&&e._cbs.push(t);return!1},cancel:function(){var e=this.options.placeHolderImg,t;this.hide(),this.sizes.forEach(function(t){if(t.loaded||!t._img)return;t._img.src=e}),t=this.getImageNode();if(!t)return;t.set("src",e)},show:function(){if(!this._hidden)return;var e=this.getImageNode();if(!e)return;this._hidden=!1,e.getDOMNode().classList.remove(this.options.fadeOutClass)},hide:function(){if(this._hidden)return;var e=this.getImageNode();if(!e)return;this._hidden=!0,e.getDOMNode().classList.add(this.options.fadeOutClass)},getSize:function(){var e="";return this.paddingLeft&&(e+=["border-left:",this.paddingLeft+"px","solid",this.normalize.fill+";"].join(" ")),this.paddingRight&&(e+=["border-right:",this.paddingRight+"px","solid",this.normalize.fill+";"].join(" ")),this.croppingHorizontal&&(e+="margin-left: "+this.croppingHorizontal+"px;"),{src:this.source?
this.source.src:null,width:this.width,height:this.height,naturalWidth:this.naturalWidth,naturalHeight:this.naturalHeight,paddingLeft:this.paddingLeft,paddingRight:this.paddingRight,style:e,source:this.source||null}},toJSON:function(){var e=this.getSize();return this.options.deferLoading?(e.src=this.options.placeHolderImg,e.loaded=!1):e.loaded=this.queueResource(this.source),e},setContainer:function(e){this.imgNode=null,this.container=e},setImageNode:function(e){this.imgNode=e,this.container=null,this.imgSelector=null},destroy:function(){clearTimeout(this._timers.getImageNode),this.photo=null,this.container=null,this.sizes=null,this.source=null,this.previous=null,e.SimpleEventEmitter.prototype.destroy.apply(this)}})},"@VERSION@",{requires:["simple-event-emitter","flutil","asset-manager-css"]});
YUI.add("display-item",function(e){var t=this.name,n=e.flutil,r;r=e.Base.create(t,e.FlickrView,[],{is:function(e,t){return this.__state||(this.__state={}),t!==undefined&&(this.__state[e]=!!t),!!this.__state[e]},fire:function(t){this.is(t,!0),e.FlickrView.prototype.fire.apply(this,arguments)},when:function(e,t){if(this.is(e))return t();this.once(e,t)},subviewConfig:null,initialize:function(){this.render()},setupSubviews:function(){var t=this,r=this.subviewConfig||this.options.subviews||[],i=Array.isArray(r)?r.slice():Object.keys(r),s=i.length,o;return s?(this.fire("rendering"),o=new e.Promise(function(r,o){var u,a;u=function(e){if(--s)return;r()},a=function(e,r){r||(r={success:!0});if(!r.success)return o(r.msg);t.subviews||(t.subviews={}),i.forEach(function(r){var i,s,o;o=n.extend({appContext:t.appContext,parent:t},t.options),delete o.templateName,delete o.container,i=t.subviews[r]=new e.Views[r](o),s=t.getContainer({subview:i}),s&&i.set("container",s),i.when("rendered",u),i.initialize()})},e.betterUse(i).then(a)}),o):e.Promise.resolve()},activateSubviews:function(){var e=this;Object.keys(this.subviews||{}).forEach(function(t){e.subviews[t].activate()})},activate:function(){this.fire("activated")},setupEvents:function(){},render:function(){this.buildContainer({})},buildContainer:function(e,t){var r,i,s,o,u,a;this._acquireEl?this._acquireEl=null:(s=this.get("container"),e=n.extend({state:this.__state,views:n.camelCaseifyKeys(this.subviews||{}),layout:{styles:this.stylesToJSON()}},e),t||(t=this.options.templateName),i=this.templates(t),r=i?i(e):'-- TEMPLATE "'+t+'" NOT FOUND --',s.setHTML(r),this.resetStyles(),u=Object.keys(e.views),!YUI.Env.isServer&&u.length&&(o=u.reduce(function(t,n){var r=e.views[n];return t[r.getId()]=r.get("container").getDOMNode(),t},{}),a=Array.prototype.slice.call(s.getDOMNode().getElementsByClassName("hb-placeholder")),a.forEach(function(e){if(!o[e.id])return;e.parentNode.replaceChild(o[e.id],e)}))),this.is("rendering",!1),this.fire("rendered",{view:this})},acquireContainer:function(e){this.set("container",e),this._acquireEl=!0,this.initialize()},setStyles:function(e,t){this._style||(this._style={}),this._style[e]||(this._style[e]={}),n.extend(this._style[e],t)},resetStyles:function(){this._style={}},stylesToJSON:function(){var e=this;return this._style||(this._style={}),Object.keys(this._style).reduce(function(t,n){var r=e._style[n];return t[n]=Object.keys(r).reduce(function(e,t){return e+t+":"+r[t]+";"},""),t},{})},updateDom:function(){if(YUI.Env.isServer)return;var e=this,t=this.get("container");this._style||(this._style={}),Object.keys(this._style).forEach(function(n){var r=e._el[n];r||(e._el[n]=r=t.getDOMNode().getAttribute("data-layout-element")===n?t:t.one('[data-layout-element="'+n+'"]'));if(!r)return;r.setStyles(e._style[n])}),this.resetStyles()},getId:function(){if(!this.__id){this.__id="DI-"+this.name.replace(/[^a-z]/gi,"").toUpperCase();var e=this.photo||this.get("photo");e&&(this.__id+="-"+e.id)}return this.__id},promiseState:function(t){var n=this,r;if(!t)throw new Error("DisplayItem.promiseState: eventName is required.");return this.is(t)?e.Promise.resolve():(r=new e.Promise(function(e,r){n.once(t,e)}),r)},remove:function(){console.warn("display-item::remove() is a no-op. Implement on a subclass if needed.")},destructor:function(){return this.subviews=null,this.__state=null,this}},{ATTRS:{container:{value:"",setter:function(e){var t=e||this.getContainer({viewName:n.unCamelCaseify(this.name)});return this.assetManager&&this.assetManager.setContainer(t),t}}}}),e.namespace("Views")[t]=r},"@VERSION@",{requires:["flutil","flickr-view","better-use","asset-manager"]});
YUI.add("hermes-template-display-item-tile",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return"ui-display-tile-video"}function d(e,t){return"ui-state-restricted-interstitial"}function v(e,t){return"ui-state-fade-out"}function m(e,t){var n="",r;return n+="if (window.paftTiming) { window.paftTiming['"+l((r=(r=e.photo,r==null||r===!1?r:r.id),typeof r===f?r.apply(e):r))+"'] = new Date().getTime(); } ",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<figure class="ui-display ui-display-tile ',u=n["if"].call(t,(o=t.photo,o==null||o===!1?o:o.isVideo),{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;s+=" ",u=n["if"].call(t,(o=t.photo,o==null||o===!1?o:o.needsInterstitial),{hash:{},inverse:c.noop,fn:c.program(3,d,i),data:i});if(u||u===0)s+=u;s+='" data-layout-element="display" style="'+l((o=(o=(o=t.layout,o==null||o===!1?o:o.styles),o==null||o===!1?o:o.display),typeof o===f?o.apply(t):o))+'">\n\n    <div class="ui-display-mask" data-action-click="open" data-action-touchstart="open" data-action-touchmove="showExif" data-layout-element="displayMask" style="'+l((o=(o=(o=t.layout,o==null||o===!1?o:o.styles),o==null||o===!1?o:o.displayMask),typeof o===f?o.apply(t):o))+'">\n		<a href="'+l((o=(o=t.photo,o==null||o===!1?o:o.url),typeof o===f?o.apply(t):o))+'" class="ui-display-link">\n			<img class="ui-display-image ',u=n.unless.call(t,(o=(o=t.photo,o==null||o===!1?o:o.current),o==null||o===!1?o:o.loaded),{hash:{},inverse:c.noop,fn:c.program(5,v,i),data:i});if(u||u===0)s+=u;s+='" src="'+l((o=(o=(o=t.photo,o==null||o===!1?o:o.current),o==null||o===!1?o:o.src),typeof o===f?o.apply(t):o))+'" width="'+l((o=(o=(o=t.photo,o==null||o===!1?o:o.current),o==null||o===!1?o:o.naturalWidth),typeof o===f?o.apply(t):o))+'" height="'+l((o=(o=(o=t.photo,o==null||o===!1?o:o.current),o==null||o===!1?o:o.naturalHeight),typeof o===f?o.apply(t):o))+'" data-layout-element="displayImage" onload="',u=n["if"].call(t,t.paft,{hash:{},inverse:c.noop,fn:c.program(7,m,i),data:i});if(u||u===0)s+=u;return s+="this.classList.remove('ui-state-fade-out');\" style=\""+l((o=(o=(o=t.photo,o==null||o===!1?o:o.current),o==null||o===!1?o:o.style),typeof o===f?o.apply(t):o))+'">\n			<div class="ui-display-shield"></div>\n		</a>\n    </div>\n\n    <button class="ui-delete-button unfluid" data-action="delete" title="',a={hash:{intlName:"groups.REMOVE_PHOTO"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'"><span>&nbsp;</span></button>\n\n    <a class="ui-bottom-gradient" href="'+l((o=(o=t.photo,o==null||o===!1?o:o.url),typeof o===f?o.apply(t):o))+'"></a>\n	<div class="meta-bar">\n		',a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,(o=t.views,o==null||o===!1?o:o.displayWidgetMeta),a):h.call(t,"outlet",(o=t.views,o==null||o===!1?o:o.displayWidgetMeta),a)))+'\n		<div class="inline-icons">\n			',a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,(o=t.views,o==null||o===!1?o:o.displayWidgetFave),a):h.call(t,"outlet",(o=t.views,o==null||o===!1?o:o.displayWidgetFave),a)))+"\n			",a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,(o=t.views,o==null||o===!1?o:o.displayWidgetComment),a):h.call(t,"outlet",(o=t.views,o==null||o===!1?o:o.displayWidgetComment),a)))+"\n		</div>\n	</div>\n\n</figure>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/display-item-tile",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-widget-fave",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){var r="",i;r+='\n        <a href="#" data-action="fave" ',i=n.unless.call(e,e.isOwner,{hash:{},inverse:a.noop,fn:a.program(2,h,t),data:t});if(i||i===0)r+=i;r+='>\n            <span class="fave-star ',i=n["if"].call(e,e.isFaved,{hash:{},inverse:a.noop,fn:a.program(7,v,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,e.isOwner,{hash:{},inverse:a.noop,fn:a.program(9,m,t),data:t});if(i||i===0)r+=i;return r+='"></span>\n            <span class="fave-counter">',(i=n.faveCount)?i=i.call(e,{hash:{},data:t}):(i=e.faveCount,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span>\n        </a>\n	",r}function h(e,t){var r="",i;r+='title="',i=n["if"].call(e,e.isFaved,{hash:{},inverse:a.program(5,d,t),fn:a.program(3,p,t),data:t});if(i||i===0)r+=i;return r+='"',r}function p(e,t){return"Remove this photo from your favorites?"}function d(e,t){return"Add this photo to your favorites?"}function v(e,t){return"is-faved"}function m(e,t){return"can-not-fave"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=this,f="function",l=this.escapeExpression;s+='<div class="ui-display-widget-fave">\n	',u=n["if"].call(t,(o=t.state,o==null||o===!1?o:o.activated),{hash:{},inverse:a.noop,fn:a.program(1,c,i),data:i});if(u||u===0)s+=u;return s+="\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/widget-fave",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("display-widget-fave",function(e){"use strict";var t,n=this.name,r=e.flutil;t=e.Base.create(n,e.Views["display-item"],[],{langBundles:this.details.langBundles,initializer:function(e){this.options=r.extend({templateName:"widget-fave"},e),this.set("photo",this.options.photo),this.processingFave=!1},initialize:function(){var e=this;this.appContext.getModel("photo-engagement-models",this.get("photo").id).then(function(t){e.set("photo-engagement",t),e.fire("activated"),e.render()})},toggleFave:function(t){var n=this,r=this.get("photo-engagement"),i=this.get("photo");t.halt(),r&&!this.processingFave&&(this.appContext.getViewer().signedIn?r.getValue("canFave")&&(this.processingFave=!0,r.registry.toggleFave(i.id),n.render(),r.remoteUpdate().then(function(){n.processingFave=!1},function(e){n.processingFave=!1,r.registry.toggleFave(i.id),n.render(),n.appContext.error(e.message)}),e.rapidTracker.beacon(this.name,"faveStarDisplayItemButtonClick")):this.promptTheUserToSignIn(i.id))},promptTheUserToSignIn:function(t){var n,r,i,s,o,u;i=this.intlMessage({intlName:"grease.YAY"}),s=this.intlMessage({intlName:"grease.JOIN_TO_FAVE_LINK",joinLink:"/signup/"}),u=this.intlMessage({intlName:"grease.SIGN_UP_TXT"}),o=this.intlMessage({intlName:"grease.SIGN_IN_TXT"}),n=new e.Views["confirmation-dialog-view"]({title:i,icon:"ui-icon-big-fave",content:s,confirmButtonClass:"ui-button-minimal",confirmButtonLabel:o,showAuxiliaryButton:!0,auxiliaryButtonLabel:u}),n.appContext=this.appContext,n.render(),n.activate(),n.on("auxiliaryClick",function(){window.location=e.url("/signup")}),r=e.Views.dialog.getNewInstance("dialog-modal",{content:n.get("container"),appContext:this.appContext}),r.show(),n.registerEventHandler(n.get("container").one(".ui-dialog-button-confirm").on("click",function(){r.close(),r.destroy(),e.SigninHelper.addPendingFave({id:t})}))},activate:function(){this.attachEvents({":fave":this.toggleFave})},render:function(){var e=this.get("photo-engagement"),t=e.getValue("faveCount");t?t>99?t="99+":t=t.toString():t="",this.buildContainer({faveCount:t,isFaved:e.getValue("isFaved"),isOwner:e.getValue("isOwner")})}}),e.namespace("Views")[n]=t},"@VERSION@",{requires:["flutil","display-item","dialog","signin-helper","confirmation-dialog-view","display-widget-fave-css","hermes-template-widget-fave","url"],langBundles:["grease"]});
YUI.add("hermes-lang-grease",function(e,t){e.Intl.add("hermes/grease","en-US",{JOIN_TO_FAVE:["You want to fave? Join Flickr!"],JOIN_TO_FAVE_LINK:['You want to fave? <a class="ui-join-link" data-action="follow" href="',"${joinLink}",'">Join Flickr!</a>'],JOIN_TO_COMMENT:["You want to comment? Join Flickr!"],JOIN_TO_COMMENT_LINK:['You want to comment? <a class="ui-join-link" data-action="follow" href="',"${joinLink}",'">Join Flickr!</a>'],JOIN_TO_EMAIL_STREAM:['You want to email this photostream? <a class="ui-join-link" data-action="follow" href="',"${joinLink}",'">Join Flickr!</a>'],JOIN_TO_SHARE_STREAM:['You want to share this photostream? <a class="ui-join-link" data-action="follow" href="',"${joinLink}",'">Join Flickr!</a>'],SIGN_IN_TO_COMMENT:["So you want to comment? Sign in and try again."],SIGN_IN_TO_FAVE:["So you want to fave? Sign in and try again."],SIGN_IN_TO_FAVE_BYE:["You must be signed in to fave. You will be redirected to signin now."],SIGN_IN_REQUIRED:["Sign in required"],OOPS:["Oops!"],YAY:["Yay!"],SIGN_UP:["Sign-up"],SIGN_IN:["Sign-in"],SIGN_UP_TXT:["Sign up"],SIGN_IN_TXT:["Sign in"],FORGET_IT:["Forget it"],NO:["No"],NO_THANKS:["No thanks"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-widget-comment",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="ui-display-widget-comment">\n	<span class="ui-link" data-action="getcomments">\n		<span class="ui-icon-comments"></span>\n		<span class="comment-counter">',(o=n.commentCount)?o=o.call(t,{hash:{},data:i}):(o=t.commentCount,o=typeof o===u?o.apply(t):o),s+=a(o)+"</span>\n	</span>\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/widget-comment",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("display-widget-comment",function(e){"use strict";var t,n=this.name,r=e.flutil;t=e.Base.create(n,e.Views["display-item"],[],{langBundles:this.details.langBundles,initializer:function(t){this.options=r.extend({templateName:"widget-comment"},t),this.set("photo",this.options.photo),this.CommentsView=e.namespace("Views")["comments-view"]},initialize:function(){var e=this;this.appContext.getModel("photo-engagement-models",this.get("photo").id).then(function(t){e.set("photo-engagement",t),e.fire("activated"),e.render()})},showCommentDialog:function(t){var n=this,r=this.get("photo"),i=new this.CommentsView({appContext:this.appContext,isTooltipComments:!0,photoId:r.id,noIcons:!0}),s,o;t.preventDefault(),this.appContext.getViewer().signedIn?(this.target=this.target||t.target.hasClass("ui-link")?t.target:t.target.ancestor(".ui-link"),this.target&&(e.rapidTracker.beacon(this.name,"commentDisplayItemButtonClick"),this.target.addClass("ui-state-fetching"),i.initialize().then(function(t){s=n.target.ancestor(".ui-display-wrapper"),o=e.Views.dialog.getInstance("dialog-tooltip",{content:i.get("container"),appendCurtainTo:n.get("container").ancestor(".ui-display-wrapper").get("parentNode"),anchorTo:n.target,positioning:!0,constraints:{top:90},parent:n,arrow:!0,id:n.getId()}),n.setEnvironmentToShowInlineComment(s,o),o.on("hide",function(){n.cleanEnvironmentAfterShowingInlineComment(s)}),n.convertCommentsIntoInlineComments(i),i.on("addingNewComment",function(){e.Views.dialog.close(),n.target.addClass("ui-state-fetching")}),i.on("newCommentAdded",function(){n.target.removeClass("ui-state-fetching"),n.updateCounter(),n.convertCommentsIntoInlineComments(i)}),i.on("commentEdited",function(){n.convertCommentsIntoInlineComments(i)}),i.on("commentDeleted",function(){n.updateCounter()}),o.show(),i.render(),n.target.removeClass("ui-state-fetching"),i.activate()}))):n.promptTheUserToSignIn(r.id)},promptTheUserToSignIn:function(t){var n,r,i,s,o,u;i=this.intlMessage({intlName:"grease.YAY"}),s=this.intlMessage({intlName:"grease.JOIN_TO_COMMENT_LINK",joinLink:"/signup/"}),u=this.intlMessage({intlName:"grease.SIGN_UP_TXT"}),o=this.intlMessage({intlName:"grease.SIGN_IN_TXT"}),n=new e.Views["confirmation-dialog-view"]({title:i,icon:"ui-icon-big-comment",content:s,confirmButtonClass:"ui-button-minimal",confirmButtonLabel:o,showAuxiliaryButton:!0,auxiliaryButtonLabel:u}),n.appContext=this.appContext,n.render(),n.activate(),n.on("auxiliaryClick",function(){window.location=e.url("/signup")}),r=e.Views.dialog.getNewInstance("dialog-modal",{content:n.get("container"),appContext:this.appContext}),r.show(),n.registerEventHandler(n.get("container").one(".ui-dialog-button-confirm").on("click",function(){r.close(),r.destroy(),e.SigninHelper.addPendingComment({id:t})}))},updateCounter:function(){this.render()},convertCommentsIntoInlineComments:function(e){var t=e.get("container");t.all(".comment-content a").each(function(e){e.setAttribute("data-action","follow")}),t.all(".comment-content img").each(function(e){e.remove()})},setEnvironmentToShowInlineComment:function(e,t){var n=e.one(".ui-display-shield");e.addClass("ui-state-inline-commenting"),this.shieldClickSubscription=n.on("click",function(e){e.halt(),t.close()})},cleanEnvironmentAfterShowingInlineComment:function(e){e.removeClass("ui-state-inline-commenting"),this.shieldClickSubscription&&this.shieldClickSubscription.detach(),this.shieldClickSubscription=null},activate:function(){this.attachEvents({":getcomments":this.showCommentDialog})},render:function(){var e=this.get("photo-engagement"),t=e.getValue("commentCount");t?t>99?t="99+":t=t.toString():t="",this.buildContainer({commentCount:t})}}),e.namespace("Views")[n]=t},"@VERSION@",{requires:["flutil","dialog","display-item","comments-view","dialog","signin-helper","display-widget-comment-css","confirmation-dialog-view","hermes-template-widget-comment","url"],langBundles:["grease"]});
YUI.add("hermes-template-widget-meta",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=n.helperMissing;return s+='<div class="ui-display-widget-meta">\n	<span class="title">\n		<a href="',(o=n.photoUrl)?o=o.call(t,{hash:{},data:i}):(o=t.photoUrl,o=typeof o===a?o.apply(t):o),s+=f(o)+'" title="',(o=n.title)?o=o.call(t,{hash:{},data:i}):(o=t.title,o=typeof o===a?o.apply(t):o),s+=f(o)+'">',(o=n.title)?o=o.call(t,{hash:{},data:i}):(o=t.title,o=typeof o===a?o.apply(t):o),s+=f(o)+'</a>\n	</span>\n	<span class="attribution">\n		',u={hash:{intlName:"widget-meta.BY_LINK",userUrl:t.userUrl,displayName:t.displayName,displayName:t.displayName},data:i},s+=f((o=n.intlHTMLMessage||t.intlHTMLMessage,o?o.call(t,u):l.call(t,"intlHTMLMessage",u)))+"\n	</span>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/widget-meta",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("display-widget-meta",function(e){"use strict";var t,n=this.name,r=e.flutil;t=e.Base.create(n,e.Views["display-item"],[],{langBundles:this.details.langBundles,initializer:function(e){this.options=r.extend({templateName:"widget-meta"},e),this.photo=this.options.photo},initialize:function(){var e=this.photo,t=e.getValue("owner"),n,r;e.getValue("isOwner")?n=this.intlMessage({intlName:"widget-meta.YOU"}):n=t.getValue("displayname"),r={title:e.getValue("title")||this.intlMessage({intlName:"default.UNTITLED"}),photoUrl:e.getValue("url"),displayName:n,userUrl:t.getValue("url")},this.render(r)},activate:function(){},render:function(e){this.buildContainer(e)}}),e.namespace("Views")[n]=t},"@VERSION@",{requires:["flutil","display-item","display-widget-meta-css","hermes-template-widget-meta"],langBundles:["widget-meta","default"]});
YUI.add("hermes-lang-widget-meta",function(e,t){e.Intl.add("hermes/widget-meta","en-US",{BY_LINK:['by <a href="',"${userUrl}",'" title="',"${displayName}",'">',"${displayName}","</a>"],YOU:["YOU!"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-lang-default",function(e,t){e.Intl.add("hermes/default","en-US",{UNTITLED:["Untitled"]})},"@VERSION@",{requires:["intl"]});
YUI.add("display-item-tile",function(e){"use strict";var t,n=this.name,r=e.flutil,i=e.Flog;t=e.Base.create(n,e.Views["display-item"],[],{langBundles:this.details.langBundles,initializer:function(t){this.options=r.extend({templateName:"display-item-tile"},t),this.subviews={},this.photo=null,this.assetManager=null,this.bleedWidth=0,this.bleedHeight=0,this.frameWidth=0,this.frameHeight=0,this._style={},this._el={},this.photo=this.options.photo||null;if(this.options.disableFave||this.options.disableMeta||this.options.disableComments)this.subviewConfig=[],this.options.disableFave||this.subviewConfig.push("display-widget-fave"),this.options.disableMeta||this.subviewConfig.push("display-widget-meta"),this.options.disableComments||this.subviewConfig.push("display-widget-comment");return this.photo&&(this.assetManager=new e.AssetManager(this.photo,{maxUpSampleAmount:.05,container:this.get("container"),selector:".ui-display-image",normalizeAspect:!0,noSquares:t.noSquares||!1})),this.paft=t.paft,this},subviewConfig:["display-widget-fave","display-widget-meta","display-widget-comment"],initialize:function(){if(this.is("rendering")||this.is("rendered"))return;this.setupSubviews().then(this.render.bind(this)).then(null,function(e){i.error("ERROR IN "+n,e.stack||e)})},activate:function(){var e=this,t;if(this.is("activating")||this.is("activated"))return;this.options.disableMeta&&this.get("container").addClass("no-meta"),this.get("container").on("click",function(e){var t=2;(e.ctrlKey||e.metaKey||e.which===t)&&e.stopPropagation()}),this.options.photoDeleteRights&&(this.options.photoDeleteRights.allPhotos?t=!0:this.options.photoDeleteRights.ownPhotos&&this.photo.getValue("isOwner")&&(t=!0),t&&(this.get("container").one(".ui-delete-button").addClass("enabled"),this.attachEvents({":delete":function(t){e.fire("deletePhoto",{photo:e.photo})}}))),this.activateSubviews(),this.fire("activated")},render:function(){this.buildContainer({paft:this.paft,photo:this.getPhotoJSON()}),this.resetStyles()},getPhotoJSON:function(){var e=this.photo.toJSON();return e.url+=this.options.context||"",e.current=this.assetManager.toJSON(),e},resize:function(e,t){this.assetManager.setSize(e,t),this.bleedWidth=this.frameWidth=this.assetManager.naturalWidth,this.bleedHeight=this.frameHeight=this.assetManager.naturalHeight,this.fitToSize(this.assetManager.width,this.assetManager.height),this.fire("resize",{width:e||null,height:t||null})},fitToSize:function(e,t){var n={};n.overflow="hidden",n.width=this.frameWidth=e,n.width+="px",n.height=this.frameHeight=t,n.height+="px",this.setStyles("displayMask",n)},hibernate:function(){var e;if(this.is("hibernating"))return;this.is("hibernating",!0),e=this.get("container"),this.assetManager&&this.assetManager.cancel(),this.ancestor=this.ancestor||e.ancestor(),this.ancestor&&this.ancestor.addClass("ui-state-hibernating")},wake:function(){var e;if(!this.is("hibernating"))return;this.is("hibernating",!1),e=this.get("container"),this.ancestor=this.ancestor||e.ancestor(),this.ancestor&&this.ancestor.removeClass("ui-state-hibernating"),this.assetManager.load()},remove:function(){var e=this.get("container");e.addClass("no-meta"),e.addClass("deleted")},destructor:function(){this._style=null,this._el=null,this.assetManager=null}}),e.namespace("Views")[n]=t},"@VERSION@",{requires:["flutil","flog","display-item","hermes-template-display-item-tile","display-item-tile-css"],optional:["display-widget-fave","display-widget-comment","display-widget-meta"],langBundles:["groups"]});
YUI.add("display-collection",function(e){"use strict";var t,n=e.flutil;t=e.Base.create("DisplayCollection",e.FlickrView,[],{initializer:function(t){this.layout=null,this.payload=[],this.displayItemExtras=t.displayItemExtras||{},this.options=n.extend({displayItemCtr:e.Views["display-item-tile"]},t),this._dataEvents=[],t.paft&&(this.paft=t.paft)},initialize:function(){var t=this,n;return n=new e.Promise(function(e,n){t.once("rendered",e),t.render()}),n=n.then(null,function(e){console.error("DisplayCollection.render",e+e.stack)}),n},activate:function(){return this},appendPhotos:function(e,t){t||(t=this.options.displayItemCtr),Array.isArray(e)||(e=[e]),this.payload=this.payload.concat(e.map(function(e){return{displayItem:null,displayItemCtr:t,type:"PhotoModel",service:null,renderBatch:null,params:{photo:e}}}))},appendDisplayItems:function(e){Array.isArray(e)||(e=[e]),this.payload=this.payload.concat(e.map(function(e){return{displayItem:e,displayItemCtr:e.constructor,type:"DisplayItem",service:null,renderBatch:null,params:null}}))},appendCollection:function(e,t){var n=this,r,i,s;t||(t=this.options.displayItemCtr),r=function(e,t){t?n.payload=i(e).concat(n.payload):n.payload=n.payload.concat(i(e))},i=function(n){return n.map(function(n){return{displayItem:null,displayItemCtr:t,type:"CollectionPaginator",service:e,renderBatch:null,params:{photo:n}}})},this.detachDataEvents(),s=e.on("listValueChanged",function(e){e.prepended?r(e.prepended,!0):r(e.added||[]),n.render()}),n._dataEvents.push(s),r(e.getCurrentPageAsList())},removePhotos:function(e){var t=this,n;n=e.map(function(e){var n;return t.payload.some(function(t){return t.params&&t.params.photo===e?(n=t,!0):!1}),n}).filter(function(e){return!!e}),n.length&&n.forEach(function(e){e.displayItem.remove()})},clear:function(){if(!this.payload||!this.payload.length)return;this.payload.forEach(function(e){e.displayItem&&e.displayItem.destroy(),e.layout=e.params=null}),this.layout&&this.layout.destroy(),this.initializer(e.merge({},this.options))},createDisplayItem:function(e){var t,r,i=this;return e.displayItem?e.displayItem:(t=n.extend(this.displayItemExtras,e.params,{appContext:this.appContext}),r=e.displayItem=new e.displayItemCtr(t),this.displayItemExtras.photoDeleteRights&&this._dataEvents.push(r.on("deletePhoto",function(e){i.fire("deletePhoto",e)})),r)},render:function(){var e=this,t;this._batch||(this._batch=0),this._batch++,t=this.payload.reduce(function(t,n){if(n.renderBatch)return t;n.renderBatch=e._batch;var r=e.createDisplayItem(n);return t.push(r),t},[]),this.layout.append(t)},positionFromHistory:function(){console.warn("display-collection::positionFromHistory() is a no-op. Implement on a subclass if needed.")},next:function(){var e=this.payload.slice(-1)[0];if(!e||!e.service||!e.service.next)return;return e.service.next()},getId:function(){return"DC-"+this.name.toUpperCase()},detachDataEvents:function(){this._dataEvents.forEach(function(e){e.detach()}),this._dataEvents=[]},destructor:function(){this.detachDataEvents(),this._dataEvents=null,this.layout&&this.layout.destroy(),this.layout=null,this.payload.forEach(function(e){e.displayItem&&e.displayItem.destroy(),e.layout=e.params=null}),this.options=null}},{ATTRS:{container:{value:"",setter:function(e){var t=e||this.getContainer({viewName:n.unCamelCaseify(this.name)});return t}}}}),e.DisplayCollection=t},"@VERSION@",{requires:["flickr-view","flutil","display-item-tile"]});
YUI.add("layout-engine",function(e){"use strict";var t,n,r,i,s=e.flutil,o,u,a;u={debug:!1,displayCollectionListSelector:'[data-layout-element="displayCollection"]'},a={},o=s.getLogger(u.debug),t=function(){e.SimpleEventEmitter.apply(this),this.payload=[],this._style={},this._el={},this.options={}},t.prototype=s.objectCreate(e.SimpleEventEmitter.prototype,{init:function(e){e||(e=this.options),this.container=e.container,this.template=e.template,this.templatePartial=e.templatePartial},renderFragment:function(e){if(!e||!e.length)return this.renderFragmentWrappers([]);var t=this,n,r,i=e.length;n=function(n){if(--i)return;t.renderFragmentWrappers(e)},r=function(e){var t=e.view||e;YUI.Env.isServer||(t.updateDom(),t.activate()),n()},e.forEach(function(e){var t=e.displayItem;if(t.is("rendered"))return r(t);t.once("rendered",r),t.initialize()})},renderFragmentWrappers:function(e){var t=this,i,s,o,a,f,l;this.container.hasChildNodes()||(f=(YUI.Env.isServer?e:e.slice(0,1)).map(function(e){return e.toTemplateJSON()}),o={displayWrappers:f,layout:{styles:this.stylesToJSON()}},this.resetStyles(),i=this.template(o),this.container.setHTML(i),YUI.Env.isServer||(a=this.container.one(u.displayCollectionListSelector),a&&a.setHTML(""))),YUI.Env.isServer||(s=new n,e.forEach(function(e){var n;e.isRendered?e.updateDom():(n=new r,n.render(t.templatePartial,e.toTemplateJSON()),e.setContainer(n.get("firstChild")),s.appendChild(e.container))}),this.updateDom(),s.numNodes()&&(l=this.container.one(u.displayCollectionListSelector),l.appendChild(s.getNode()))),this.fire("rendered")},setStyles:function(e,t){this._style[e]||(this._style[e]={}),s.extend(this._style[e],t)},stylesToJSON:function(){var e=this;return Object.keys(this._style).reduce(function(t,n){var r=e._style[n];return t[n]=Object.keys(r).reduce(function(e,t){return e+t+":"+r[t]+";"},""),t},{})},updateDom:function(){if(YUI.Env.isServer)return;var e=this,t=this.container||this.get("container");Object.keys(this._style).forEach(function(n){var r=e._el[n];r||(e._el[n]=r=t.getDOMNode().getAttribute("data-layout-element")===n?t:t.one('[data-layout-element="'+n+'"]'));if(!r)return;r.setStyles(e._style[n])}),this.resetStyles()},resetStyles:function(){this._style={}},render:function(){console.warn("layout-engine::render() is a no-op. Implement on a subclass if needed.")},append:function(){console.warn("layout-engine::append() is a no-op. Implement on a subclass if needed.")},remove:function(){console.warn("layout-engine::remove() is a no-op. Implement on a subclass if needed.")},scrollTo:function(){console.warn("layout-engine::scrollTo() is a no-op. Implement on a subclass if needed.")},destroy:function(){var t=this.container.one(u.displayCollectionListSelector);t&&t.remove(),this.options=null,this.container.detach(),this.container=null,this._el=null,this._style=null,e.SimpleEventEmitter.prototype.destroy.apply(this)}}),i=t.DisplayWrapper=function(e){this.layout=null,this.container=null,this.displayItem=e,this._style={},this._el={},this.isRendered=!1},i.prototype={setContainer:function(e){this.container=e;var t=this.container.one(".view");t&&this.displayItem.acquireContainer(t),this.isRendered=!0},bindLayout:function(e){this.layout=e},hasLayout:function(){return!!this.layout},setStyles:function(e,t){this._style[e]||(this._style[e]={}),s.extend(this._style[e],t)},position:function(e,t){this.setStyles("displayWrapper",{top:e+"px",left:t+"px"}),this.displayItem.fire("position",{top:e||null,left:t||null})},resetStyles:function(){this._style={}},updateDom:function(){if(YUI.Env.isServer)return;var e=this,t=this.container;Object.keys(this._style).forEach(function(n){var r=e._el[n];r||(e._el[n]=r=t.getDOMNode().getAttribute("data-layout-element")===n?t:t.one('[data-layout-element="'+n+'"]'));if(!r)return;r.setStyles(e._style[n])}),this.resetStyles()},getId:function(){return"DW"+this.displayItem.photo.id},toStylesJSON:function(){var e=this;return Object.keys(this._style).reduce(function(t,n){var r=e._style[n];return t[n]=Object.keys(r).reduce(function(e,t){return e+t+":"+r[t]+";"},""),t},{})},toTemplateJSON:function(){return{layout:{styles:this.toStylesJSON()},displayItem:this.displayItem,id:this.getId()}},destroy:function(){}},n=t.DocumentFragment=function(){this.init()},n.prototype=YUI.Env.isServer?{init:function(){this.html=""},appendChild:function(e){this.html+=e.html},getNode:function(){return this}}:{init:function(e){this._nodes=0,this._fragment=document.createDocumentFragment()},appendChild:function(e){this._nodes++,this._fragment.appendChild(e.getDOMNode())},getNode:function(){return this._fragment},numNodes:function(){return this._nodes}},r=t.DocumentElement=function(){this.init()},r.prototype=YUI.Env.isServer?{init:function(){this.html=""},render:function(e,t){this.setHTML(e(t))},setHTML:function(e){this.html=e},get:function(e){if(e==="firstChild")return this},getDOMNode:function(){return null}}:{init:function(){this.el=document.createElement("div")},setHTML:function(e){this.el.innerHTML=e},render:function(e,t){this.setHTML(e(t));var n=Object.keys(t).reduce(function(e,n){return t[n].render&&(e[t[n].getId()]=t[n].get("container").getDOMNode()),e},{});Array.prototype.slice.call(this.el.getElementsByClassName("hb-placeholder")).forEach(function(e){e.parentNode.replaceChild(n[e.id],e)})},get:function(t){if(t==="firstChild")return e.one(this.el.firstChild)},getDOMNode:function(){return this.el}},e.LayoutEngine=t},"@VERSION@",{requires:["flutil","flickr-promise","simple-event-emitter"]});
YUI.add("layout-engine-justified-row",function(e){"use strict";var t,n=e.flutil,r,i;i={debug:!1,sizeBreakPoint:1500,sizeBump:1.3},r=n.getLogger(i.debug),t=function(t){e.SimpleEventEmitter.apply(this),this.payload=[],this.layoutEngine=null,this.rowIndex=null,this.options=n.extend({vertPadding:5,horizPadding:5,targetHeight:299,targetHeightTolerance:.29,width:"auto",layoutEngine:{}},t),this._targetRange={},this.init()},t.prototype=n.objectCreate(e.SimpleEventEmitter.prototype,{init:function(e){e||(e=this.options),this.height=0,this.displayWidth=this.availableWidth=typeof e.width=="number"?e.width:800,this.width=0,this.overflow=0,this.offsetTop=0},bindLayout:function(e){this.layoutEngine=e.layoutEngine,this.rowIndex=e.rowIndex},addItem:function(e){var t,n=this.getTargetAreaSize();this.payload.push(e);if(this.getScaledWidth()>this.displayWidth&&this.payload.length>1){t=this.getScaledHeight();if(t<n.minHeight||t>n.maxHeight){this.payload.pop(),e.bindLayout(null);return}}e.bindLayout({row:this})},end:function(){var e;e=this.getScaledWidth(this.targetHeight),this.displayWidth=Math.min(e,this.availableWidth)},clear:function(){this.displayWidth=this.availableWidth,this.payload.forEach(function(e){e.bindLayout(null)});var e=this.payload;return this.payload=[],e},getTargetAreaSize:function(){if(this._targetRange._displayWidth===this.displayWidth)return this._targetRange;var e=this.displayWidth>i.sizeBreakPoint?this.options.targetHeight*i.sizeBump:this.options.targetHeight,t=Math.floor(e*(1-this.options.targetHeightTolerance)),n=Math.ceil(e*(1+this.options.targetHeightTolerance));return this._targetRange={_displayWidth:this.displayWidth,targetHeight:e,minHeight:t,maxHeight:n}},computeLayout:function(){var e=this.getTargetAreaSize();return this.height=this.getScaledHeight(),this.height<e.minHeight?this.height=e.minHeight:this.height>e.maxHeight&&(this.height=e.maxHeight),this.width=this.getScaledWidth(this.height),this.overflow=this.width-this.displayWidth,this.offsetTop=this.layoutEngine.getRowStackHeight(this.rowIndex-1)+this.rowIndex*this.options.vertPadding,!0},getAspectRatio:function(){return this.payload.reduce(function(e,t){return e+t.displayItem.assetManager.getAspectRatio()},0)},getScaledWidth:function(e,t){var n;return e||(e=this.getTargetAreaSize().targetHeight),t=t===undefined?this.options.horizPadding:t|0,n=this.getAspectRatio()*e+t*(this.payload.length-1),Math.ceil(n)},getScaledHeight:function(){var e,t;return t=this.getAspectRatio(),e=this.displayWidth-(this.payload.length-1)*this.options.horizPadding,Math.ceil(1/t*e)},render:function(){var e=this,t,n,i;t=this.computeLayout();if(!t){r.log("JustifiedRow.computeLayout found no solution");return}n=this.overflow/this.payload.length|0,i=0,this.payload.forEach(function(t){var r=t.displayItem,s,o;t.position(e.offsetTop,i),o=i===0?e.overflow-n*(e.payload.length-1):n,s=r.assetManager.getScaledWidth(e.height)-o,r.resize(s,e.height),i+=r.frameWidth+e.options.horizPadding})},getWrappers:function(){return this.payload||[]},destroy:function(){this.payload.forEach(function(e){e.bindLayout(null)}),this.payload=null,this.options=null,this.layoutEngine=null,e.SimpleEventEmitter.prototype.destroy.apply(this)}}),e.LayoutEngineJustifiedRow=t},"@VERSION@",{requires:["flutil","flickr-promise","simple-event-emitter"]});
YUI.add("hermes-template-display-collection-justified-item",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=n.helperMissing;return s+='<div class="ui-display-wrapper ui-display-wrapper-justified" id="',(o=n.id)?o=o.call(t,{hash:{},data:i}):(o=t.id,o=typeof o===a?o.apply(t):o),s+=f(o)+'" data-layout-element="displayWrapper" style="'+f((o=(o=(o=t.layout,o==null||o===!1?o:o.styles),o==null||o===!1?o:o.displayWrapper),typeof o===a?o.apply(t):o))+'">\n	',u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t.displayItem,u):l.call(t,"outlet",t.displayItem,u)))+"\n</div>\n\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/display-collection-justified-item",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
